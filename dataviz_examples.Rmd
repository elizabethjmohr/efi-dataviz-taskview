---
title: "Data Visualization Examples"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE) # Show code and plots

# Load packages
library(tidyverse)
library(lubridate)
library(cowplot)
library(palmerpenguins)
library(ggridges)
library(ggdist)
library(ggExtra)
library(viridis)

# Get target data
aquatics_targets <- readr::read_csv("https://data.ecoforecast.org/targets/aquatics/aquatics-targets.csv.gz")
#terrestrial_30min_targets <- readr::read_csv("https://data.ecoforecast.org/targets/terrestrial/terrestrial_30min-targets.csv.gz", guess_max = 1e6)
#terrestrial_daily_targets <- readr::read_csv("https://data.ecoforecast.org/targets/terrestrial/terrestrial_daily-targets.csv.gz", guess_max = 1e6)
pheno_targets <- readr::read_csv("https://data.ecoforecast.org/targets/phenology/phenology-targets.csv.gz")
#tick_targets <- readr::read_csv("https://data.ecoforecast.org/targets/ticks/ticks-targets.csv.gz")
beetle_targets <- readr::read_csv("https://data.ecoforecast.org/targets/beetles/beetles-targets.csv.gz", guess_max = 1e6)

# Get forecasts
combined <- read_csv("https://data.ecoforecast.org/analysis/combined_forecasts_scores.csv.gz")
aquatic_temp <- combined %>% 
  filter(theme == "aquatics", target == "temperature", !team == "EFInull")
#aquatic_oxygen <- combined %>%
  #filter(theme == "aquatics", target == "oxygen", !team == "EFInull")
#terrestrial_30min <- combined %>% 
  #filter(theme == "terrestrial_30min", !team == "EFInull")
#terrestrial_daily <- combined %>% 
  #filter(theme == "terrestrial_daily", !team == "EFInull")
#pheno <- combined %>% 
  #filter(theme == "phenology", !team == "EFInull")
#ticks <- combined %>% 
  #filter(theme == "ticks", !team == "EFInull")
#beetles <- combined %>% 
  #filter(theme == "beetles", !team == "EFInull")
```

## Histogram

```{r histogram, fig.cap = "Histogram of scores for water temperature forecasts from the EFI NEON Ecological Forecasting Challenge"}

ggplot(aquatic_temp, aes(x = crps)) +
  geom_bar()+
  scale_x_binned()+
  theme_minimal_hgrid()+
  ylab("number of forecasts") + 
  xlab("continuous ranked probability score")
```
```{r histogram2D}
p <- ggplot(pheno_targets, aes(x = gcc_90, y = rcc_90)) +
  geom_hex(bins = 60)+
  geom_point(color = "transparent")+
  ylab("greenness index") + 
  xlab("redness index")+
  theme_cowplot()+
  scale_fill_viridis()+
  theme(legend.position = c(0.8, 0.8))

ggMarginal(p,type = "histogram", fill = "grey80")

```

## Density Plot

```{r density, fig.cap = "Density plot for a log-normal distribution with mean = 0 and standard deviation = 1"}
ggplot() +
  geom_area(data = tibble(x = seq(0.01, 4, 0.01), y = dlnorm(seq(0.01, 4, 0.01))), aes(x = x, y = y), fill = "#66CCEE", color = "black")+
  #geom_function(data = tibble(x = c(0,3)), aes(x = x), fun = dlnorm)+
  xlim(c(0,4))+
  theme_minimal_hgrid()+
  ylab("probability density")+
  theme(axis.title.x = element_blank())
```

## Quantile Dotplots

```{r qdotplot}

```

## Boxplot 

```{r boxplot, warning=FALSE, fig.cap="Body-mass distributions for three penguin species shown as boxplots."}
ggplot(data = penguins) +
  geom_boxplot(aes(x = species, y = body_mass_g), fill = "#BBBBBB") +
  theme_minimal() +
  xlab("species") +
  ylab("body mass (g)")
```

## Violin Plot

```{r violin, warning=FALSE, fig.cap="Body-mass distributions for three penguin species shown as violin plots."}
ggplot(data = penguins) +
  geom_violin(aes(x = species, y = body_mass_g), fill = "#BBBBBB") +
  theme_cowplot() +
  xlab("species") +
  ylab("body mass (g)")
```

## Ridgeline Plot 

```{r ridgeline, warning=FALSE, fig.cap="Body-mass distributions for three penguin species shown as staggered density plots or 'ridgeline' plots."}
ggplot(data = penguins) +
  geom_density_ridges(aes(x = body_mass_g, y = species), fill = "#BBBBBB") +
  theme_minimal_grid() +
  xlab("species") +
  ylab("body mass (g)")
```

## Scatterplot

```{r scatterplot, warning=FALSE, fig.cap="Scatterplot of penguin flipper length vs. body mass."}
ggplot(data = penguins) +
  geom_point(aes(x = flipper_length_mm, y = body_mass_g)) +
  theme_minimal_grid() +
  xlab("flipper length (mm)") +
  ylab("body mass (g)")
```

## Line graph

```{r line, fig.cap="Line graph of dissolved oxygen concentrations at the Posey Creek NEON site, 2019-2020"}
aquatics_targets %>% 
  filter(year(time) <= 2020, 
         year(time) >= 2019,
         siteID == "POSE") %>%
  ggplot(aes(x = time, y = oxygen))+
  geom_line()+
  theme_minimal_grid()+
  ylab(expression(paste("dissolved oxygen (mg ", L^-1, ")")))+
  theme(axis.title.x = element_blank())
```

```{r pointline, fig.cap="Line graph with dots showing dissolved oxygen concentrations at the Posey Creek NEON site, June 2021"}
aquatics_targets %>% 
  filter(year(time) == 2021, 
         month(time) == 6,
         siteID == "POSE") %>%
  ggplot(aes(x = time, y = oxygen))+
  geom_line()+
  geom_point()+
  theme_minimal_grid()+
  ylab(expression(paste("dissolved oxygen (mg ", L^-1, ")")))+
  theme(axis.title.x = element_blank())
```

## Pairs plots and Correlograms

```{r pairs}

```

```{r corr}

```

## Barplots

```{r barplot, fig.cap="Number of penguins observed at three islands in Palmer Archipelago, Antarctica, 2007-2009."}
ggplot(data = penguins) +
  geom_bar(aes(x = island), fill = "#4477AA") +
  theme_minimal_hgrid() +
  xlab("island") +
  ylab("count")
```

## Dotplot

```{r dotplot}

```

## Heatmap

```{r heatmap}

```

## Composite Plots

```{r composite}

```

```{r facet}

```
